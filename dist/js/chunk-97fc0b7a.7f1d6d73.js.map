{"version":3,"sources":["webpack:///./src/utils/crud/mixins/crud-instance.js","webpack:///./src/utils/crud/components/CrudTableServerMode.vue?3b10","webpack:///src/utils/crud/components/CrudTableServerMode.vue","webpack:///./src/utils/crud/components/CrudTableServerMode.vue?ea6f","webpack:///./src/utils/crud/components/CrudTableServerMode.vue","webpack:///./src/utils/crud/mixins/crud-table.js"],"names":["props","selected","computed","this","map","item","meta","id","itemsList","tableFields","primaryKey","customButtons","activeColumnName","$t","page","methods","runItemsViewRefreshing","beforeGetItem","getItem","then","editItemDialog","resetItem","createItemDialog","obj","updateItem","confirm","deleteItem","length","openAlertBox","setSelectedIds","multipleEditDialog","checkSelected","mulitipleItemsUpdate","ids","selectedIds","request","active","mulitipleItemsDelete","name","index","getItemIndex","$parent","custom","itemElements","setItemElementsInfo","getItemElements","render","_vm","_h","$createElement","_c","_self","attrs","createMode","editMode","deleteMode","selectManyMode","updateManyMode","removeManyMode","mainFilter","fieldFilters","refreshButton","exportButton","excelLoading","search","selectedStatuses","columnFilters","on","create","editSelected","suspendSelected","restoreSelected","destroySelected","refreshItemsView","updateColumnFilterMode","updateColumnFilterValue","updateSearch","updateSelectedStatuses","clearFilters","exportToExcel","pagination","headers","items","footerProps","totalItems","loading","$event","scopedSlots","_u","_l","header","i","key","fn","ref","value","editButton","edit","suspend","restore","destroy","editItemElements","resolveRowDoubleClick","_t","textMode","pageStart","pageStop","itemsLength","setPage","model","callback","$$v","expression","staticRenderFns","mixins","components","Controls","searching","newSearchRequest","ignorePaginationWatcher","searchTimeout","sortBy","sortDesc","rowsPerPage","itemsPerPage","filterColumns","mode","resetPage","clearTimeout","setTimeout","getItemsServerSide","params","searchItems","response","newItemId","setCurrentItem","getItemDetails","showItemDetailsDialog","indexOf","cleanHeaders","text","filteredItems","http","post","prefix","path","body","data","row","push","excel","export_json_to_excel","filename","excelName","autoWidth","bookType","error","statusText","resetItems","watch","deep","val","component","VCard","VDataTable","goToItemButton","button","moveItemDirection","currentIndex","currentItemIndex","possible","Math","ceil","moveDetailsItem","moveItem"],"mappings":"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","file":"js/chunk-97fc0b7a.7f1d6d73.js","sourcesContent":["import {\n  mapState,\n  mapGetters,\n  mapMutations,\n  mapActions,\n} from 'vuex'\n\nexport default {\n  props: [\n    'itemsViewConfig',\n    'tableFields',\n    'deleteMode',\n    'customButtons',\n    'itemElements',\n    'editButton',\n    'meta',\n    'primaryKey',\n    'activeColumnName',\n    'createMode',\n    'editMode',\n    'mainFilter',\n    'fieldFilters',\n    'exportButton',\n    'refreshButton',\n    'selectManyMode',\n    'updateManyMode',\n    'removeManyMode',\n  ],\n  data () {\n    return {\n      selected: [],\n    }\n  },\n  computed: {\n    ...mapState('app', ['page']),\n    ...mapState('crud', [\n      'prefix',\n      'path',\n      'currentItemIndex',\n      'currentItemId',\n    ]),\n    ...mapGetters('crud', ['itemsList']),\n    selectedIds () {\n      return this.selected.map(item => item.meta.id)\n    },\n    items () {\n      return this.itemsList(\n        this.tableFields,\n        this.meta,\n        this.primaryKey,\n        this.customButtons,\n        this.activeColumnName\n      )\n    },\n    excelName () {\n      return this.$t(`global.routes.${this.page}`)\n    },\n  },\n  methods: {\n    ...mapMutations('crud', [\n      'showItemDetailsDialog',\n      'setCurrentItem',\n      'resetItems',\n      'resetItem',\n      'editItemDialog',\n      'createItemDialog',\n      'multipleEditDialog',\n      'setItemElementsInfo',\n      'editItemElementsDialog',\n      'setSelectedIds',\n    ]),\n    ...mapActions('crud', [\n      'getItem',\n      'updateItem',\n      'storeItem',\n      'deleteItem',\n      'getItemElements',\n      'mulitipleItemsUpdate',\n      'mulitipleItemsDelete',\n      'getItemDetails',\n      'runItemsViewRefreshing',\n    ]),\n    ...mapActions(['openAlertBox']),\n    refreshItemsView () {\n      this.runItemsViewRefreshing()\n    },\n    edit (id) {\n      this.beforeGetItem(id)\n      this.getItem([id]).then(() => {\n        this.editItemDialog(id)\n      })\n    },\n    create () {\n      this.resetItem()\n      this.createItemDialog()\n    },\n    suspend (id) {\n      const obj = {}\n      obj[this.activeColumnName] = 0\n      this.updateItem([\n        id,\n        obj,\n        this.$t('global.alerts.suspended'),\n        this.$t('global.alerts.suspendError'),\n      ])\n    },\n    restore (id) {\n      const obj = {}\n      obj[this.activeColumnName] = 1\n      this.updateItem([\n        id,\n        obj,\n        this.$t('global.alerts.restored'),\n        this.$t('global.alerts.restoreError'),\n      ])\n    },\n    destroy (id) {\n      if (confirm(this.$t('global.alerts.confirm'))) {\n        this.deleteItem([\n          id,\n          this.$t('global.alerts.deleted'),\n          this.$t('global.alerts.deleteError'),\n        ])\n      }\n    },\n    checkSelected () {\n      if (this.selected.length === 0) {\n        this.openAlertBox([\n          'alertError',\n          this.$t('global.datatable.noItemsSelected'),\n        ])\n        return false\n      }\n      if (confirm(this.$t('global.datatable.confirm'))) {\n        return true\n      }\n      return false\n    },\n    editSelected () {\n      if (this.selected.length === 0) {\n        this.openAlertBox([\n          'alertError',\n          this.$t('global.datatable.noItemsSelected'),\n        ])\n        return false\n      }\n\n      this.setSelectedIds(this.selected)\n      this.resetItem()\n      this.multipleEditDialog()\n    },\n    suspendSelected () {\n      if (this.checkSelected()) {\n        this.mulitipleItemsUpdate([\n          {\n            ids: this.selectedIds,\n            request: {\n              active: 0,\n            },\n          },\n          this.$t('global.alerts.suspended'),\n          this.$t('global.alerts.suspendError'),\n        ])\n      }\n    },\n    restoreSelected () {\n      if (this.checkSelected()) {\n        this.mulitipleItemsUpdate([\n          {\n            ids: this.selectedIds,\n            request: {\n              active: 1,\n            },\n          },\n          this.$t('global.alerts.restored'),\n          this.$t('global.alerts.restoreError'),\n        ])\n      }\n    },\n    destroySelected () {\n      if (this.checkSelected()) {\n        this.mulitipleItemsDelete([\n          {\n            ids: this.selectedIds,\n          },\n          this.$t('global.alerts.deleted'),\n          this.$t('global.alerts.deleteError'),\n        ])\n      }\n    },\n    custom (name, item) {\n      const index = this.getItemIndex(item.meta.id)\n      this.$parent.custom(name, item, index)\n    },\n    editItemElements (name, id) {\n      const obj = this.itemElements[name]\n      this.setItemElementsInfo([\n        id,\n        obj,\n      ])\n      this.getItemElements()\n    },\n  },\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',{attrs:{\"flat\":\"\"}},[_c('controls',{attrs:{\"create-mode\":_vm.createMode,\"edit-mode\":_vm.editMode,\"delete-mode\":_vm.deleteMode,\"select-many-mode\":_vm.selectManyMode,\"update-many-mode\":_vm.updateManyMode,\"remove-many-mode\":_vm.removeManyMode,\"main-filter\":_vm.mainFilter,\"field-filters\":_vm.fieldFilters,\"refresh-button\":_vm.refreshButton,\"export-button\":_vm.exportButton,\"excel-loading\":_vm.excelLoading,\"initialSearch\":_vm.search,\"initialSelectedStatuses\":_vm.selectedStatuses,\"initialColumnFilters\":_vm.columnFilters},on:{\"create\":_vm.create,\"editSelected\":_vm.editSelected,\"suspendSelected\":_vm.suspendSelected,\"restoreSelected\":_vm.restoreSelected,\"destroySelected\":_vm.destroySelected,\"refreshItemsView\":_vm.refreshItemsView,\"updateColumnFilterMode\":_vm.updateColumnFilterMode,\"updateColumnFilterValue\":_vm.updateColumnFilterValue,\"updateSearch\":_vm.updateSearch,\"updateSelectedStatuses\":_vm.updateSelectedStatuses,\"clearFilters\":_vm.clearFilters,\"exportToExcel\":_vm.exportToExcel}}),_c('v-data-table',{attrs:{\"show-select\":_vm.selectManyMode,\"options\":_vm.pagination,\"headers\":_vm.headers,\"items\":_vm.items,\"item-key\":\"meta.id\",\"no-results-text\":_vm.$t('global.datatable.noMatchingResults'),\"no-data-text\":_vm.$t('global.datatable.noDataAvailable'),\"footer-props\":_vm.footerProps,\"items-per-page\":20,\"server-items-length\":_vm.totalItems,\"loading\":_vm.loading,\"light\":\"\",\"multi-sort\":\"\",\"dense\":\"\"},on:{\"update:options\":function($event){_vm.pagination=$event}},scopedSlots:_vm._u([_vm._l((_vm.headers),function(header,i){return {key:(\"item.\" + (header.value)),fn:function(ref){\nvar item = ref.item;\nreturn [_c('span',{key:i},[(header.value==='actions')?_c('list-item-actions',{attrs:{\"item\":item,\"edit-button\":_vm.editButton,\"custom-buttons\":_vm.customButtons,\"delete-mode\":_vm.deleteMode,\"item-elements\":_vm.itemElements,\"edit-mode\":_vm.editMode,\"select-many-mode\":_vm.selectManyMode},on:{\"edit\":_vm.edit,\"custom\":_vm.custom,\"suspend\":_vm.suspend,\"restore\":_vm.restore,\"destroy\":_vm.destroy,\"editItemElements\":_vm.editItemElements,\"doubleClick\":_vm.resolveRowDoubleClick}}):_c('span',[_vm._t((\"field:\" + (header.value)),[_c('list-item-field',{attrs:{\"value\":item[header.value],\"text-mode\":_vm.textMode(item, header.value)}})],{\"value\":item[header.value],\"item\":item})],2)],1)]}}}),{key:\"footer.page-text\",fn:function(ref){\nvar pageStart = ref.pageStart;\nvar pageStop = ref.pageStop;\nvar itemsLength = ref.itemsLength;\nreturn [_c('table-footer',{attrs:{\"pagination\":_vm.pagination,\"page-start\":pageStart,\"page-stop\":pageStop,\"items-length\":itemsLength},on:{\"setPage\":_vm.setPage}})]}}],null,true),model:{value:(_vm.selected),callback:function ($$v) {_vm.selected=$$v},expression:\"selected\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card flat>\n    <controls\n      :create-mode=\"createMode\"\n      :edit-mode=\"editMode\"\n      :delete-mode=\"deleteMode\"\n      :select-many-mode=\"selectManyMode\"\n      :update-many-mode=\"updateManyMode\"\n      :remove-many-mode=\"removeManyMode\"\n      :main-filter=\"mainFilter\"\n      :field-filters=\"fieldFilters\"\n      :refresh-button=\"refreshButton\"\n      :export-button=\"exportButton\"\n      :excel-loading=\"excelLoading\"\n      :initialSearch=\"search\"\n      :initialSelectedStatuses=\"selectedStatuses\"\n      :initialColumnFilters=\"columnFilters\"\n      @create=\"create\"\n      @editSelected=\"editSelected\"\n      @suspendSelected=\"suspendSelected\"\n      @restoreSelected=\"restoreSelected\"\n      @destroySelected=\"destroySelected\"\n      @refreshItemsView=\"refreshItemsView\"\n      @updateColumnFilterMode=\"updateColumnFilterMode\"\n      @updateColumnFilterValue=\"updateColumnFilterValue\"\n      @updateSearch=\"updateSearch\"\n      @updateSelectedStatuses=\"updateSelectedStatuses\"\n      @clearFilters=\"clearFilters\"\n      @exportToExcel=\"exportToExcel\"\n    >\n    </controls>\n\n    <!-- Table -->\n    <v-data-table\n      v-model=\"selected\"\n      :show-select=\"selectManyMode\"\n      :options.sync=\"pagination\"\n      :headers=\"headers\"\n      :items=\"items\"\n      item-key=\"meta.id\"\n      :no-results-text=\"$t('global.datatable.noMatchingResults')\"\n      :no-data-text=\"$t('global.datatable.noDataAvailable')\"\n      :footer-props=\"footerProps\"\n      :items-per-page=\"20\"\n      :server-items-length=\"totalItems\"\n      :loading=\"loading\"\n      light\n      multi-sort\n      dense\n    >\n      <template\n        v-for=\"(header, i) in headers\"\n        v-slot:[`item.${header.value}`]=\"{ item }\"\n      >\n        <span :key=\"i\">\n          <list-item-actions\n            v-if=\"header.value==='actions'\"\n            :item=\"item\"\n            :edit-button='editButton'\n            :custom-buttons='customButtons'\n            :delete-mode='deleteMode'\n            :item-elements=\"itemElements\"\n            :edit-mode=\"editMode\"\n            :select-many-mode=\"selectManyMode\"\n            @edit=\"edit\"\n            @custom=\"custom\"\n            @suspend=\"suspend\"\n            @restore=\"restore\"\n            @destroy=\"destroy\"\n            @editItemElements=\"editItemElements\"\n            @doubleClick=\"resolveRowDoubleClick\"\n          />\n          <span v-else>\n            <slot\n              :name=\"`field:${header.value}`\"\n              :value=\"item[header.value]\"\n              :item=\"item\"\n            >\n              <list-item-field\n                :value=\"item[header.value]\"\n                :text-mode=\"textMode(item, header.value)\"\n              />\n            </slot>\n          </span>\n        </span>\n      </template>\n      <template slot=\"footer.page-text\" slot-scope=\"{ pageStart, pageStop, itemsLength }\">\n        <table-footer\n          @setPage=\"setPage\"\n          :pagination=\"pagination\"\n          :page-start=\"pageStart\"\n          :page-stop=\"pageStop\"\n          :items-length=\"itemsLength\"\n        ></table-footer>\n      </template>\n    </v-data-table>\n  </v-card>\n</template>\n\n<script>\n\nimport Vue from 'vue'\nimport {\n  mapState,\n  mapActions,\n} from 'vuex'\n\nimport CrudInstanceMixin from '../mixins/crud-instance'\nimport ControlsHandlerMixin from '../mixins/controls-handler'\nimport ItemsViewMixin from '../mixins/items-view'\nimport CrudTableMixin from '../mixins/crud-table'\nimport HelperMixin from '../mixins/table'\n\nimport { getItemsList } from '../helpers/functions'\n\nimport Controls from './Controls.vue'\n\nexport default {\n  name: 'CrudTableServerMode',\n  mixins: [\n    CrudInstanceMixin,\n    ControlsHandlerMixin,\n    ItemsViewMixin,\n    CrudTableMixin,\n    HelperMixin,\n  ],\n  components: {\n    Controls,\n  },\n  data () {\n    return {\n      searching: false,\n      newSearchRequest: false,\n      ignorePaginationWatcher: false,\n      searchTimeout: null,\n    }\n  },\n  computed: {\n    ...mapState('crud', [\n      'totalItems',\n      'loading',\n      'detailsDialog',\n      'isItemsViewRefreshed',\n    ]),\n    params () {\n      return {\n        sortBy: this.pagination.sortBy,\n        sortDesc: this.pagination.sortDesc,\n        rowsPerPage: this.pagination.itemsPerPage,\n        page: this.pagination.page,\n        search: this.search,\n        filterColumns: this.columnFilters,\n        selectedStatuses: this.selectedStatuses,\n        deleteMode: this.deleteMode,\n        activeColumnName: this.activeColumnName,\n        mode: 'paginate',\n      }\n    },\n  },\n  methods: {\n    ...mapActions('crud', ['getItemsServerSide']),\n    ...mapActions(['openAlertBox']),\n    searchItems (resetPage) {\n      clearTimeout(this.searchTimeout)\n      if (resetPage) {\n        this.ignorePaginationWatcher = true\n        this.pagination.page = 1\n      }\n      this.searchTimeout = setTimeout(() => {\n        this.getItemsServerSide([this.params])\n      }, 500)\n    },\n    startSearching () {\n      this.searchItems(true)\n    },\n    moveDetailsItem (page, index) {\n      this.ignorePaginationWatcher = true\n      this.pagination.page = page\n      this.getItemsServerSide([this.params]).then((response) => {\n        const newItemId = this.items[index].meta.id\n        this.setCurrentItem({ id: newItemId, index })\n        this.getItemDetails([newItemId]).then((response) => {\n          this.showItemDetailsDialog()\n        })\n      })\n    },\n    getItemIndex (id) {\n      return this.items.map((item) => item.meta.id).indexOf(id)\n    },\n    exportToExcel () {\n      this.excelLoading = true\n      const headers = this.cleanHeaders.map(header => header.text)\n      const params = {}\n      for (const key in this.params) {\n        params[key] = this.params[key]\n      }\n      params.mode = 'all'\n      let filteredItems\n      Vue.http.post(`${this.prefix}/${this.path}/search`, params)\n        .then((response) => {\n          const items = response.body\n          filteredItems = items.map(obj => getItemsList(obj, this.tableFields, this.meta, this.primaryKey, this.customButtons, this.activeColumnName))\n          const data = filteredItems.map((item) => {\n            const row = []\n            for (const header of this.cleanHeaders) {\n              row.push(item[header.value])\n            }\n            return row\n          })\n          import('../vendor/Export2Excel').then((excel) => {\n            this.excelLoading = false\n            excel.export_json_to_excel({\n              header: headers,\n              data,\n              filename: this.excelName,\n              autoWidth: true,\n              bookType: 'xlsx',\n            })\n          })\n        }, (error) => {\n          this.excelLoading = false\n          this.openAlertBox([\n            'alertError',\n            error.statusText,\n          ])\n        })\n    },\n  },\n  created () {\n    this.resetItems()\n  },\n  watch: {\n    pagination: {\n      handler () {\n        if (!this.ignorePaginationWatcher) {\n          this.searchItems(false)\n        }\n        this.ignorePaginationWatcher = false\n      },\n      deep: true,\n    },\n    detailsDialog (val) {\n      if (!val) {\n        this.getItemsServerSide([this.params])\n      }\n    },\n    isItemsViewRefreshed (val) {\n      if (val) {\n        this.getItemsServerSide([this.params])\n      }\n    },\n  },\n}\n</script>\n","import mod from \"-!../../../../node_modules/vuetify-loader/lib/loader.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CrudTableServerMode.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/vuetify-loader/lib/loader.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CrudTableServerMode.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CrudTableServerMode.vue?vue&type=template&id=306a838a&\"\nimport script from \"./CrudTableServerMode.vue?vue&type=script&lang=js&\"\nexport * from \"./CrudTableServerMode.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VDataTable } from 'vuetify/lib/components/VDataTable';\ninstallComponents(component, {VCard,VDataTable})\n","import {\n  mapState,\n  mapMutations,\n} from 'vuex'\n\nexport default {\n  computed: {\n    ...mapState('crud', [\n      'nextItem',\n      'moveItemRun',\n      'moveItemDirection',\n    ]),\n  },\n  methods: {\n    ...mapMutations('crud', [\n      'setCurrentItem',\n      'moveItem',\n    ]),\n    beforeGetItem (id) {\n      const index = this.getItemIndex(id)\n      this.setCurrentItem({\n        id,\n        index,\n      })\n    },\n    resolveRowDoubleClick (item, index) {\n      if (this.editMode) {\n        let goToItemButton = false\n        for (const button of this.customButtons) {\n          if (button.name === 'goToItem') {\n            goToItemButton = true\n            break\n          }\n        }\n        if (goToItemButton) {\n          this.custom('goToItem', item, index)\n        } else {\n          this.edit(item.meta.id, index)\n        }\n      }\n    },\n  },\n  watch: {\n    moveItemRun (val) {\n      if (val) {\n        const {\n          moveItemDirection,\n        } = this\n        let currentIndex = this.currentItemIndex\n        let {\n          page,\n        } = this.pagination\n        const {\n          itemsPerPage,\n        } = this.pagination\n        const {\n          totalItems,\n        } = this\n        let possible = true\n        if (moveItemDirection === 'previous') {\n          if (currentIndex > 0) {\n            currentIndex -= 1\n          } else if (page > 1) {\n            page -= 1\n            currentIndex = itemsPerPage - 1\n          } else {\n            possible = false\n          }\n        } else if (moveItemDirection === 'next') {\n          if (currentIndex < itemsPerPage - 1 && (page - 1) * itemsPerPage + currentIndex + 1 <\n            totalItems) {\n            currentIndex += 1\n          } else if (page < Math.ceil(totalItems / itemsPerPage)) {\n            page += 1\n            currentIndex = 0\n          } else {\n            possible = false\n          }\n        }\n        if (possible) {\n          this.moveDetailsItem(page, currentIndex)\n        }\n        this.moveItem([\n          '',\n          false,\n        ])\n      }\n    },\n  },\n}\n"],"sourceRoot":""}