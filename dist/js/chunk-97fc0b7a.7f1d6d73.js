(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-97fc0b7a"],{2492:function(e,t,s){"use strict";var i=s("2f62");t["a"]={props:["itemsViewConfig","tableFields","deleteMode","customButtons","itemElements","editButton","meta","primaryKey","activeColumnName","createMode","editMode","mainFilter","fieldFilters","exportButton","refreshButton","selectManyMode","updateManyMode","removeManyMode"],data(){return{selected:[]}},computed:{...Object(i["e"])("app",["page"]),...Object(i["e"])("crud",["prefix","path","currentItemIndex","currentItemId"]),...Object(i["c"])("crud",["itemsList"]),selectedIds(){return this.selected.map(e=>e.meta.id)},items(){return this.itemsList(this.tableFields,this.meta,this.primaryKey,this.customButtons,this.activeColumnName)},excelName(){return this.$t(`global.routes.${this.page}`)}},methods:{...Object(i["d"])("crud",["showItemDetailsDialog","setCurrentItem","resetItems","resetItem","editItemDialog","createItemDialog","multipleEditDialog","setItemElementsInfo","editItemElementsDialog","setSelectedIds"]),...Object(i["b"])("crud",["getItem","updateItem","storeItem","deleteItem","getItemElements","mulitipleItemsUpdate","mulitipleItemsDelete","getItemDetails","runItemsViewRefreshing"]),...Object(i["b"])(["openAlertBox"]),refreshItemsView(){this.runItemsViewRefreshing()},edit(e){this.beforeGetItem(e),this.getItem([e]).then(()=>{this.editItemDialog(e)})},create(){this.resetItem(),this.createItemDialog()},suspend(e){const t={};t[this.activeColumnName]=0,this.updateItem([e,t,this.$t("global.alerts.suspended"),this.$t("global.alerts.suspendError")])},restore(e){const t={};t[this.activeColumnName]=1,this.updateItem([e,t,this.$t("global.alerts.restored"),this.$t("global.alerts.restoreError")])},destroy(e){confirm(this.$t("global.alerts.confirm"))&&this.deleteItem([e,this.$t("global.alerts.deleted"),this.$t("global.alerts.deleteError")])},checkSelected(){return 0===this.selected.length?(this.openAlertBox(["alertError",this.$t("global.datatable.noItemsSelected")]),!1):!!confirm(this.$t("global.datatable.confirm"))},editSelected(){if(0===this.selected.length)return this.openAlertBox(["alertError",this.$t("global.datatable.noItemsSelected")]),!1;this.setSelectedIds(this.selected),this.resetItem(),this.multipleEditDialog()},suspendSelected(){this.checkSelected()&&this.mulitipleItemsUpdate([{ids:this.selectedIds,request:{active:0}},this.$t("global.alerts.suspended"),this.$t("global.alerts.suspendError")])},restoreSelected(){this.checkSelected()&&this.mulitipleItemsUpdate([{ids:this.selectedIds,request:{active:1}},this.$t("global.alerts.restored"),this.$t("global.alerts.restoreError")])},destroySelected(){this.checkSelected()&&this.mulitipleItemsDelete([{ids:this.selectedIds},this.$t("global.alerts.deleted"),this.$t("global.alerts.deleteError")])},custom(e,t){const s=this.getItemIndex(t.meta.id);this.$parent.custom(e,t,s)},editItemElements(e,t){const s=this.itemElements[e];this.setItemElementsInfo([t,s]),this.getItemElements()}}}},"329a":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-card",{attrs:{flat:""}},[s("controls",{attrs:{"create-mode":e.createMode,"edit-mode":e.editMode,"delete-mode":e.deleteMode,"select-many-mode":e.selectManyMode,"update-many-mode":e.updateManyMode,"remove-many-mode":e.removeManyMode,"main-filter":e.mainFilter,"field-filters":e.fieldFilters,"refresh-button":e.refreshButton,"export-button":e.exportButton,"excel-loading":e.excelLoading,initialSearch:e.search,initialSelectedStatuses:e.selectedStatuses,initialColumnFilters:e.columnFilters},on:{create:e.create,editSelected:e.editSelected,suspendSelected:e.suspendSelected,restoreSelected:e.restoreSelected,destroySelected:e.destroySelected,refreshItemsView:e.refreshItemsView,updateColumnFilterMode:e.updateColumnFilterMode,updateColumnFilterValue:e.updateColumnFilterValue,updateSearch:e.updateSearch,updateSelectedStatuses:e.updateSelectedStatuses,clearFilters:e.clearFilters,exportToExcel:e.exportToExcel}}),s("v-data-table",{attrs:{"show-select":e.selectManyMode,options:e.pagination,headers:e.headers,items:e.items,"item-key":"meta.id","no-results-text":e.$t("global.datatable.noMatchingResults"),"no-data-text":e.$t("global.datatable.noDataAvailable"),"footer-props":e.footerProps,"items-per-page":20,"server-items-length":e.totalItems,loading:e.loading,light:"","multi-sort":"",dense:""},on:{"update:options":function(t){e.pagination=t}},scopedSlots:e._u([e._l(e.headers,(function(t,i){return{key:"item."+t.value,fn:function(a){var o=a.item;return[s("span",{key:i},["actions"===t.value?s("list-item-actions",{attrs:{item:o,"edit-button":e.editButton,"custom-buttons":e.customButtons,"delete-mode":e.deleteMode,"item-elements":e.itemElements,"edit-mode":e.editMode,"select-many-mode":e.selectManyMode},on:{edit:e.edit,custom:e.custom,suspend:e.suspend,restore:e.restore,destroy:e.destroy,editItemElements:e.editItemElements,doubleClick:e.resolveRowDoubleClick}}):s("span",[e._t("field:"+t.value,[s("list-item-field",{attrs:{value:o[t.value],"text-mode":e.textMode(o,t.value)}})],{value:o[t.value],item:o})],2)],1)]}}})),{key:"footer.page-text",fn:function(t){var i=t.pageStart,a=t.pageStop,o=t.itemsLength;return[s("table-footer",{attrs:{pagination:e.pagination,"page-start":i,"page-stop":a,"items-length":o},on:{setPage:e.setPage}})]}}],null,!0),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},a=[],o=s("2b0e"),r=s("2f62"),l=s("2492"),n=s("4cfd"),d=s("8cd2"),m=s("e19b"),c=s("5a8b"),h=s("0dfe"),u=s("4c4d"),p={name:"CrudTableServerMode",mixins:[l["a"],n["a"],d["a"],m["a"],c["a"]],components:{Controls:u["a"]},data(){return{searching:!1,newSearchRequest:!1,ignorePaginationWatcher:!1,searchTimeout:null}},computed:{...Object(r["e"])("crud",["totalItems","loading","detailsDialog","isItemsViewRefreshed"]),params(){return{sortBy:this.pagination.sortBy,sortDesc:this.pagination.sortDesc,rowsPerPage:this.pagination.itemsPerPage,page:this.pagination.page,search:this.search,filterColumns:this.columnFilters,selectedStatuses:this.selectedStatuses,deleteMode:this.deleteMode,activeColumnName:this.activeColumnName,mode:"paginate"}}},methods:{...Object(r["b"])("crud",["getItemsServerSide"]),...Object(r["b"])(["openAlertBox"]),searchItems(e){clearTimeout(this.searchTimeout),e&&(this.ignorePaginationWatcher=!0,this.pagination.page=1),this.searchTimeout=setTimeout(()=>{this.getItemsServerSide([this.params])},500)},startSearching(){this.searchItems(!0)},moveDetailsItem(e,t){this.ignorePaginationWatcher=!0,this.pagination.page=e,this.getItemsServerSide([this.params]).then(e=>{const s=this.items[t].meta.id;this.setCurrentItem({id:s,index:t}),this.getItemDetails([s]).then(e=>{this.showItemDetailsDialog()})})},getItemIndex(e){return this.items.map(e=>e.meta.id).indexOf(e)},exportToExcel(){this.excelLoading=!0;const e=this.cleanHeaders.map(e=>e.text),t={};for(const s in this.params)t[s]=this.params[s];let i;t.mode="all",o["a"].http.post(`${this.prefix}/${this.path}/search`,t).then(t=>{const a=t.body;i=a.map(e=>Object(h["c"])(e,this.tableFields,this.meta,this.primaryKey,this.customButtons,this.activeColumnName));const o=i.map(e=>{const t=[];for(const s of this.cleanHeaders)t.push(e[s.value]);return t});s.e("chunk-03bdb9f4").then(s.bind(null,"706d")).then(t=>{this.excelLoading=!1,t.export_json_to_excel({header:e,data:o,filename:this.excelName,autoWidth:!0,bookType:"xlsx"})})},e=>{this.excelLoading=!1,this.openAlertBox(["alertError",e.statusText])})}},created(){this.resetItems()},watch:{pagination:{handler(){this.ignorePaginationWatcher||this.searchItems(!1),this.ignorePaginationWatcher=!1},deep:!0},detailsDialog(e){e||this.getItemsServerSide([this.params])},isItemsViewRefreshed(e){e&&this.getItemsServerSide([this.params])}}},g=p,I=s("2877"),b=s("6544"),f=s.n(b),v=s("b0af"),S=s("8fea"),x=Object(I["a"])(g,i,a,!1,null,null,null);t["default"]=x.exports;f()(x,{VCard:v["a"],VDataTable:S["a"]})},e19b:function(e,t,s){"use strict";var i=s("2f62");t["a"]={computed:{...Object(i["e"])("crud",["nextItem","moveItemRun","moveItemDirection"])},methods:{...Object(i["d"])("crud",["setCurrentItem","moveItem"]),beforeGetItem(e){const t=this.getItemIndex(e);this.setCurrentItem({id:e,index:t})},resolveRowDoubleClick(e,t){if(this.editMode){let s=!1;for(const e of this.customButtons)if("goToItem"===e.name){s=!0;break}s?this.custom("goToItem",e,t):this.edit(e.meta.id,t)}}},watch:{moveItemRun(e){if(e){const{moveItemDirection:e}=this;let t=this.currentItemIndex,{page:s}=this.pagination;const{itemsPerPage:i}=this.pagination,{totalItems:a}=this;let o=!0;"previous"===e?t>0?t-=1:s>1?(s-=1,t=i-1):o=!1:"next"===e&&(t<i-1&&(s-1)*i+t+1<a?t+=1:s<Math.ceil(a/i)?(s+=1,t=0):o=!1),o&&this.moveDetailsItem(s,t),this.moveItem(["",!1])}}}}}}]);
//# sourceMappingURL=chunk-97fc0b7a.7f1d6d73.js.map